
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Calm Baby Map</title>
<link rel="icon" href="./favicon.ico">
<link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192.png">
<link rel="apple-touch-icon" href="./icons/icon-192.png">
<link rel="manifest" href="./manifest.webmanifest">
<meta name="theme-color" content="#4b0082">
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#ffffff;color:#4b0082}
  .app{max-width:860px;margin:0 auto;padding:20px}
  .card{background:#f8f0ff;border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(75,0,130,.25)}
  h1{margin:.2rem 0 0.4rem;color:#4b0082}
  h2{color:#6a0dad;margin:.2rem 0 1rem}
  .grid{display:grid;gap:10px}
  button{padding:12px;background:#ffffff;border:2px solid #a64ca6;border-radius:12px;color:#4b0082;font-weight:500;cursor:pointer;text-align:left}
  button:hover{background:#e6ccff}
  .note{background:#f0e6ff;border:1px solid #c299ff;padding:8px 10px;border-radius:10px;color:#4b0082;margin-top:10px}
  .pill{display:inline-block;background:#a64ca6;color:#ffffff;padding:6px 10px;border-radius:999px;font-weight:800;margin-bottom:8px}
  .back{margin-top:10px;display:inline-block;color:#6a0dad;font-weight:600;cursor:pointer}
  .subtitle{font-size:1rem;font-weight:700;color:#6a0dad;margin-bottom:1rem}
  .footer{margin-top:12px;color:#6a0dad;font-size:.9rem}
</style>
</head>
<body>
<div class="app">
  <div class="card">
    <h1>The Calm Baby Map</h1>
    <div class="subtitle">for my baby Lydia</div>
    <div id="content" role="main" aria-live="polite"></div>
    <div class="footer">Tip: add this page to your home screen to use it like an app. Works offline after the first load.</div>
  </div>
</div>
<script>
if ('serviceWorker' in navigator) { window.addEventListener('load', ()=> navigator.serviceWorker.register('./service-worker.js')); }

const flow = {
  start: { text: "Choose a scenario", options: [
    {text: "Breastfeeding: latch/full feeds", next: "bf_start"},
    {text: "Crying + pushing away", next: "cry_start"},
    {text: "Cluster feeding (evening)", next: "cluster_start"}
  ]},
  bf_start: { text: "What's happening right now?", options: [
    {text: "Baby won‚Äôt latch", next: "bf_wont"},
    {text: "Latch hurts / shallow", next: "bf_shallow"},
    {text: "Baby too sleepy at breast", next: "bf_sleepy"},
    {text: "Feeding but not getting full", next: "bf_notfull"}
  ]},
  bf_wont: { text: "Try in order", list: [
    "Skin-to-skin in dim light for 2‚Äì3 min.",
    "Laid-back position; nose-to-nipple; wait for wide mouth.",
    "Soften a firm breast (hand-express 1‚Äì2 min).",
    "Drip a little milk on lip; bring baby on chin-first.",
    "Offer 1‚Äì5 mL expressed milk, then reattempt latch."
  ], options: [
    {text: "Baby latched ‚Üí keep milk flowing", next: "bf_active"},
    {text: "Still no latch ‚Üí protect supply & feed expressed milk", next: "bf_protect"}
  ], back: "bf_start" },
  bf_active: { text: "Keep milk flowing", list: [
    "Watch suck‚Äìswallow rhythm.",
    "Breast compressions when sucking slows.",
    "Burp and switch sides if sleepy."
  ], note: "If most feeds are still tough after 24‚Äì48h, book an IBCLC and check weight/diapers.", back: "bf_start" },
  bf_protect: { text: "Protect milk supply this feed", list: [
    "Pump 10‚Äì15 min (both sides).",
    "Feed expressed milk.",
    "Try latching next feed; repeat steps above."
  ], options: [{text: "Happening most feeds? ‚Üí Get hands-on help", next: "bf_help"}], back: "bf_start" },
  bf_help: { text: "Get hands-on help", list: [
    "Book an IBCLC.",
    "Check diapers (‚â•6 wets & ‚â•3‚Äì4 yellow stools/day after day 4).",
    "Follow plan while protecting supply."
  ], back: "bf_start" },
  bf_shallow: { text: "Deepen the latch", list: [
    "Nose-to-nipple; wait for wide mouth.",
    "Bring baby to you, chin first.",
    "Try football or side-lying hold.",
    "If pain >30 sec, break seal and relatch."
  ], back: "bf_start" },
  bf_sleepy: { text: "Wake and engage", list: [
    "Skin-to-skin; undress to diaper.",
    "Rub feet/back, quick diaper change.",
    "Breast compressions to keep swallowing."
  ], back: "bf_start" },
  bf_notfull: { text: "Boost transfer", list: [
    "Start on fuller side; compressions.",
    "Switch sides when swallowing slows; burp in between.",
    "Warm compress/massage before let-down."
  ], back: "bf_start" },
  cry_start: { text: "Pick what fits best", options: [
    {text: "Loud cry + pushing away", next: "cry_overstim"},
    {text: "Fussy during/after feed", next: "cry_feed"},
    {text: "Seems overtired", next: "cry_tired"},
    {text: "Possible discomfort", next: "cry_comfort"}
  ]},
  cry_overstim: { text: "Reset stimulation", list: [
    "Dim lights, lower noise.",
    "Hold upright facing away; sway.",
    "Once calmer, soothe normally."
  ], back: "cry_start" },
  cry_feed: { text: "Is it during or after feeding?", options: [
    {text: "During feed ‚Üí Adjust", next: "cry_during"},
    {text: "After feed ‚Üí Post-feed soothe", next: "cry_after"}
  ], back: "cry_start" },
  cry_during: { text: "Adjust the feed", list: [
    "Pause to burp; keep upright.",
    "Bottle: tweak nipple flow.",
    "Breast: try laid-back or side-lying; relatch."
  ], back: "cry_start" },
  cry_after: { text: "Post-feed soothe", list: [
    "Hold upright 10‚Äì20 min.",
    "Colic hold.",
    "Avoid active play right away."
  ], back: "cry_start" },
  cry_tired: { text: "Settle for sleep", list: [
    "Swaddle (if under ~8 weeks and not rolling).",
    "Dark room + white noise.",
    "Slow rocking/bouncing."
  ], back: "cry_start" },
  cry_comfort: { text: "Quick comfort checks", list: [
    "Diaper, clothing tags, hair tourniquet.",
    "Gas relief: burp, bicycle legs.",
    "If persistent, call provider."
  ], back: "cry_start" },
  cluster_start: { text: "How does this evening look?", options: [
    {text: "Multiple consecutive hours", next: "cluster_prolonged"},
    {text: "Frequent but calm between", next: "cluster_calm"},
    {text: "Frequent and crying", next: "cluster_fussy"},
    {text: "It‚Äôs past midnight", next: "cluster_latenight"}
  ]},
  cluster_prolonged: { text: "Set up for the long haul", list: [
    "Pick evening nest.",
    "Feed both sides; compressions.",
    "Between feeds: burp, change, hold.",
    "Rotate holds to protect your body."
  ], options: [
    {text: "Baby calm between", next: "cluster_calm"},
    {text: "Baby fussy between", next: "cluster_fussy"}
  ], back: "cluster_start" },
  cluster_calm: { text: "Content between feeds", list: [
    "Pace yourself: break every 30‚Äì45 min.",
    "Support holds; side-lying.",
    "If sore: drizzle milk to help latch."
  ], back: "cluster_start" },
  cluster_fussy: { text: "Fussy between feeds", list: [
    "Lower stimulation.",
    "Burp more than usual; colic hold.",
    "Swaddle reset."
  ], back: "cluster_start" },
  cluster_latenight: { text: "When cluster rolls past midnight", list: [
    "Switch to night mode.",
    "Contact sleep or bassinet with warm-up.",
    "Protect one longer stretch."
  ], back: "cluster_start" }
};

let stack = ["start"];

function babyBurst(){
  const baby = document.createElement('div');
  baby.textContent = 'üë∂üòä';
  baby.style.position = 'fixed';
  baby.style.fontSize = '4rem';
  baby.style.zIndex = 9999;
  baby.style.left = (window.innerWidth/2 - 32) + 'px';
  baby.style.top = (window.innerHeight/2 - 32) + 'px';
  baby.style.transition = 'opacity .9s ease';
  document.body.appendChild(baby);
  setTimeout(()=>{ baby.style.opacity = '0'; }, 50);
  setTimeout(()=>baby.remove(), 950);
}

function render(key){
  const node = flow[key];
  let html = `<h2>${node.text}</h2>`;
  if(node.list){ html += '<ul>' + node.list.map(x=>`<li>${x}</li>`).join('') + '</ul>'; }
  if(node.options){
    html += '<div class="grid">' + node.options.map(o=>`<button onclick="go('${o.next}')">${o.text}</button>`).join('') + '</div>';
  }
  if(node.note){ html += `<div class="note">${node.note}</div>`; }
  if(node.back){ html += `<div class="back" onclick="back()">‚Üê Back</div>`; }
  document.getElementById('content').innerHTML = html;
}

function go(next){
  stack.push(next);
  babyBurst();
  render(next);
}

function back(){
  stack.pop();
  render(stack[stack.length-1]);
}

render("start");
</script>
</body>
</html>
